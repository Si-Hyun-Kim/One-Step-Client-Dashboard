<!-- views/apps.ejs -->
<!doctype html>
<html lang="ko">
    <head>
        <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
        <title>Apps â€¢ One Step FW</title><link rel="stylesheet" href="/styles.css"/>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
        <script src="/common.js" defer></script>
        <script src="/charts.js" defer></script>
    </head>
    <body>
        <%- include('partials/_sidebar', { active }) %>
        <div class="page">
            <%- include('partials/_topbar') %>
            <main class="content">
            <section class="grid two">
                <div class="card">
                <div class="card-head"><h3>Top Applications (share)</h3></div>
                <canvas id="appsChart" height="140"></canvas>
                </div>
                <div class="card">
                <div class="card-head"><h3>Applications</h3></div>
                <div class="table-wrap">
                    <table><thead><tr><th>Name</th><th>Traffic %</th></tr></thead>
                    <tbody>
                        <% for (const a of apps) { %>
                        <tr><td><%= a.name %></td><td><%= a.pct %></td></tr>
                        <% } %>
                    </tbody>
                    </table>
                </div>
                </div>
            </section>
            </main>
        </div>
        <script>
            const APPS = <%- JSON.stringify(apps) %>;

            window.addEventListener("DOMContentLoaded", () => {
                ChartTheme.initThemeFromStorage();
                ChartTheme.bindThemeToggle();

                ChartBuilder.buildAppsChart(APPS);
                ChartBuilder.applyChartTheme();
            });
        </script>

    </body>
</html>
